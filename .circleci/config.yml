version: 2
jobs:
  build:
    docker:
      - image: ribakov/workspace:2017.3.0p2
    steps:
      - checkout
      - run:
          name: Fetch dependencies
          command: nuget restore SolucionTutor.sln
      - run:
          name: Build
          # Stopped using msbuild due to issues with copying NuGet dependencies into test projects
          command: xbuild
      - run:
          name: Test Reactive Tutor
          command: nunit3-console ./TutoringModule/ReactiveTutor/Its.TutoringModule.ReactiveTutorTest/bin/Debug/Its.TutoringModule.ReactiveTutorTest.dll --noresult
      - run:
          name: Test Collective Model Tutor
          command: nunit3-console ./TutoringModule/CollectiveModelTutor/Its.TutoringModule.CMTutorTest/bin/Debug/Its.TutoringModule.CMTutorTest.dll --noresult